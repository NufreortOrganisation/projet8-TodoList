{% extends 'base.html.twig' %}

{% block header_img %}<img class="slide-image" src="{{ asset('img/todolist_content.jpg') }}" alt="todo list">{% endblock %}

{% block body %}
<div class="flex-column">
  <div class="d-flex justify-content-end">
      <a href="{{ path('task_create') }}" class="btn btn-info">Créer une tâche</a>
  </div>

  <div class="row">
      {% for task in tasks %}
      <div class="col-sm-4 col-lg-4 col-md-4" >
          <div class="thumbnail">
              <div class="caption" style="height: 250px;">
                  <h4 class="pull-right">
                      {% if task.isDone %}<span class="glyphicon glyphicon-ok"></span>{% else %}<span class="glyphicon glyphicon-remove"></span>{% endif %}
                  </h4>
                  <h4><a href="{{ path('task_edit', {'id' : task.id }) }}">{{ task.title }}</a></h4>
                  <p class="text-danger font-weight-bold">Créée par :
                      {% if task.createdBy.username is defined %}
                          {{task.createdBy.username}}
                      {% else %}
                          {{"Anonymous"}}
                      {% endif %}
                  </p>
                  <p>
                    {% if task.startAt %}
                        <span class="font-weight-bold">Début :</span> {{ task.startAt|format_datetime('short', 'none', locale='fr') }}
                    {% else %}
                        <span class="font-weight-bold">Début :</span> -
                    {% endif %}
                     /
                    {% if task.endAt %}
                        <span class="font-weight-bold">Fin :</span> {{ task.endAt|format_datetime('short', 'none', locale='fr') }}
                    {% else %}
                        <span class="font-weight-bold">Fin :</span> -
                    {% endif %}
                  </p>
                  <hr />
                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                      Détails
                  </button>

                  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">

                      <p>{{ task.content }}</p>

                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                  </div>
                </div>
              </div>

              </div>
              <div>
                  <form action="{{ path('task_toggle', {'id' : task.id }) }}">
                      <button class="btn btn-success btn-sm pull-right">
                          {% if not task.isDone %}Marquer comme faite{% else %}Marquer non terminée{% endif %}
                      </button>
                  </form>
                  {% if app.user == task.createdBy or app.user.roles.0 == 'ROLE_ADMIN' %}
                      <form action="{{ path('task_delete', {'id' : task.id }) }}">
                          <button class="btn btn-danger btn-sm pull-right">Supprimer</button>
                      </form>
                  {% endif %}
              </div>
          </div>
      </div>
      {% else %}
          <div class="alert alert-warning" role="alert">
              Il n'y a pas encore de tâche enregistrée. <a href="{{ path('task_create') }}" class="btn btn-warning pull-right">Créer une tâche</a>
          </div>
      {% endfor %}
  </div>
</div>



{% endblock %}
